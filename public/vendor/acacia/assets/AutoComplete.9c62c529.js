import{Z as L,aa as d,a5 as r,ad as _,U as N,i as a,V as I,s as v,x as k,F as y,t as V,k as c,v as E,j as F,w as S,K as A,W as j,an as x,r as H,O as M,o as n,q as h,z as O,a2 as P,M as z,y as D}from"./vendor.05df324e.js";import{O as U}from"./overlayeventbus.esm.d529c5a8.js";import{s as q}from"./button.esm.cbb15c31.js";import{R as W}from"./ripple.esm.574b991d.js";import{s as Z}from"./virtualscroller.esm.adfef9da.js";import{_ as J}from"./plugin-vue_export-helper.21dcd24c.js";const Q={name:"AutoComplete",inheritAttrs:!1,emits:["update:modelValue","item-select","item-unselect","dropdown-click","clear","complete"],props:{modelValue:null,suggestions:{type:Array,default:null},field:{type:[String,Function],default:null},optionGroupLabel:null,optionGroupChildren:null,scrollHeight:{type:String,default:"200px"},dropdown:{type:Boolean,default:!1},dropdownMode:{type:String,default:"blank"},autoHighlight:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},minLength:{type:Number,default:1},delay:{type:Number,default:300},appendTo:{type:String,default:"body"},forceSelection:{type:Boolean,default:!1},completeOnFocus:{type:Boolean,default:!1},inputClass:null,inputStyle:null,class:null,style:null,panelClass:null,virtualScrollerOptions:{type:Object,default:null}},timeout:null,outsideClickListener:null,resizeListener:null,scrollHandler:null,overlay:null,virtualScroller:null,data(){return{searching:!1,focused:!1,overlayVisible:!1,inputTextValue:null,highlightItem:null}},watch:{suggestions(){this.searching&&(this.suggestions&&this.suggestions.length?this.showOverlay():this.hideOverlay(),this.searching=!1)}},beforeUnmount(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(L.clear(this.overlay),this.overlay=null)},updated(){this.overlayVisible&&this.alignOverlay()},methods:{getOptionIndex(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionRenderKey(e){return this.getItemContent(e)},getOptionGroupRenderKey(e){return d.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupLabel(e){return d.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren(e){return d.resolveFieldData(e,this.optionGroupChildren)},onOverlayEnter(e){L.set("overlay",e,this.$primevue.config.zIndex.overlay),this.alignOverlay(),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.autoHighlight&&this.suggestions&&this.suggestions.length&&r.addClass(this.list.firstElementChild,"p-highlight")},onOverlayLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.overlay=null},onOverlayAfterLeave(e){L.clear(e)},alignOverlay(){let e=this.multiple?this.$refs.multiContainer:this.$refs.input;this.appendDisabled?r.relativePosition(this.overlay,e):(this.overlay.style.minWidth=r.getOuterWidth(e)+"px",r.absolutePosition(this.overlay,e))},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&this.overlay&&this.isOutsideClicked(e)&&this.hideOverlay()},document.addEventListener("click",this.outsideClickListener))},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new _(this.$refs.container,()=>{this.overlayVisible&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&this.hideOverlay()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isOutsideClicked(e){return!this.overlay.contains(e.target)&&!this.isInputClicked(e)&&!this.isDropdownClicked(e)},isInputClicked(e){return this.multiple?e.target===this.$refs.multiContainer||this.$refs.multiContainer.contains(e.target):e.target===this.$refs.input},isDropdownClicked(e){return this.$refs.dropdownButton?e.target===this.$refs.dropdownButton||this.$refs.dropdownButton.$el.contains(e.target):!1},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},selectItem(e,t){if(this.multiple){if(this.$refs.input.value="",this.inputTextValue="",!this.isSelected(t)){let i=this.modelValue?[...this.modelValue,t]:[t];this.$emit("update:modelValue",i)}}else this.$emit("update:modelValue",t);this.$emit("item-select",{originalEvent:e,value:t}),this.focus(),this.hideOverlay()},onMultiContainerClick(e){this.focus(),this.completeOnFocus&&this.search(e,"","click")},removeItem(e,t){let i=this.modelValue[t],p=this.modelValue.filter((u,l)=>t!==l);this.$emit("update:modelValue",p),this.$emit("item-unselect",{originalEvent:e,value:i})},onDropdownClick(e){this.focus();const t=this.$refs.input.value;this.dropdownMode==="blank"?this.search(e,"","dropdown"):this.dropdownMode==="current"&&this.search(e,t,"dropdown"),this.$emit("dropdown-click",{originalEvent:e,query:t})},getItemContent(e){return this.field?d.resolveFieldData(e,this.field):e},showOverlay(){this.overlayVisible=!0},hideOverlay(){this.overlayVisible=!1},focus(){this.$refs.input.focus()},search(e,t,i){t!=null&&(i==="input"&&t.trim().length===0||(this.searching=!0,this.$emit("complete",{originalEvent:e,query:t})))},onInputClicked(e){this.completeOnFocus&&this.search(e,"","click")},onInput(e){this.inputTextValue=e.target.value,this.timeout&&clearTimeout(this.timeout);let t=e.target.value;this.multiple||this.$emit("update:modelValue",t),t.length===0?(this.hideOverlay(),this.$emit("clear")):t.length>=this.minLength?this.timeout=setTimeout(()=>{this.search(e,t,"input")},this.delay):this.hideOverlay()},onFocus(){this.focused=!0},onBlur(){this.focused=!1},onKeyDown(e){if(this.overlayVisible){let t=r.findSingle(this.list,"li.p-highlight");switch(e.which){case 40:if(t){let i=this.findNextItem(t);i&&(r.addClass(i,"p-highlight"),r.removeClass(t,"p-highlight"),i.scrollIntoView({block:"nearest",inline:"start"}))}else t=this.list.firstElementChild,r.hasClass(t,"p-autocomplete-item-group")&&(t=this.findNextItem(t)),t&&r.addClass(t,"p-highlight");e.preventDefault();break;case 38:if(t){let i=this.findPrevItem(t);i&&(r.addClass(i,"p-highlight"),r.removeClass(t,"p-highlight"),i.scrollIntoView({block:"nearest",inline:"start"}))}e.preventDefault();break;case 13:t&&(this.selectHighlightItem(e,t),this.hideOverlay()),e.preventDefault();break;case 27:this.hideOverlay(),e.preventDefault();break;case 9:t&&this.selectHighlightItem(e,t),this.hideOverlay();break}}if(this.multiple)switch(e.which){case 8:if(this.modelValue&&this.modelValue.length&&!this.$refs.input.value){let t=this.modelValue[this.modelValue.length-1],i=this.modelValue.slice(0,-1);this.$emit("update:modelValue",i),this.$emit("item-unselect",{originalEvent:e,value:t})}break}},selectHighlightItem(e,t){if(this.optionGroupLabel){let i=this.suggestions[t.dataset.group];this.selectItem(e,this.getOptionGroupChildren(i)[t.dataset.index])}else this.selectItem(e,this.suggestions[t.dataset.index])},findNextItem(e){let t=e.nextElementSibling;return t?r.hasClass(t,"p-autocomplete-item-group")?this.findNextItem(t):t:null},findPrevItem(e){let t=e.previousElementSibling;return t?r.hasClass(t,"p-autocomplete-item-group")?this.findPrevItem(t):t:null},onChange(e){if(this.forceSelection){let t=!1,i=e.target.value.trim();if(this.suggestions)for(let p of this.suggestions){let u=this.field?d.resolveFieldData(p,this.field):p;if(u&&i===u.trim()){t=!0,this.selectItem(e,p);break}}t||(this.$refs.input.value="",this.inputTextValue="",this.$emit("clear"),this.multiple||this.$emit("update:modelValue",null))}},isSelected(e){let t=!1;if(this.modelValue&&this.modelValue.length){for(let i=0;i<this.modelValue.length;i++)if(d.equals(this.modelValue[i],e)){t=!0;break}}return t},overlayRef(e){this.overlay=e},listRef(e,t){this.list=e,t&&t(e)},virtualScrollerRef(e){this.virtualScroller=e},onOverlayClick(e){U.emit("overlay-click",{originalEvent:e,target:this.$el})}},computed:{containerClass(){return["p-autocomplete p-component p-inputwrapper",this.class,{"p-autocomplete-dd":this.dropdown,"p-autocomplete-multiple":this.multiple,"p-inputwrapper-filled":this.modelValue||this.inputTextValue&&this.inputTextValue.length,"p-inputwrapper-focus":this.focused}]},inputFieldClass(){return["p-autocomplete-input p-inputtext p-component",this.inputClass,{"p-autocomplete-dd-input":this.dropdown,"p-disabled":this.$attrs.disabled}]},multiContainerClass(){return["p-autocomplete-multiple-container p-component p-inputtext",{"p-disabled":this.$attrs.disabled,"p-focus":this.focused}]},panelStyleClass(){return["p-autocomplete-panel p-component",this.panelClass,{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},inputValue(){if(this.modelValue)if(this.field&&typeof this.modelValue=="object"){const e=d.resolveFieldData(this.modelValue,this.field);return e!=null?e:this.modelValue}else return this.modelValue;else return""},listId(){return N()+"_list"},appendDisabled(){return this.appendTo==="self"},appendTarget(){return this.appendDisabled?null:this.appendTo},virtualScrollerDisabled(){return!this.virtualScrollerOptions}},components:{Button:q,VirtualScroller:Z},directives:{ripple:W}},X=["aria-owns","aria-expanded"],Y=["value","aria-controls"],$={class:"p-autocomplete-token-label"},ee=["onClick"],te={class:"p-autocomplete-input-token"},le=["aria-controls"],ie={key:2,class:"p-autocomplete-loader pi pi-spinner pi-spin"},se=["id"],ne=["onClick","data-index"],re={class:"p-autocomplete-item-group"},ae=["onClick","data-group","data-index"];function oe(e,t,i,p,u,l){const R=H("Button"),T=H("VirtualScroller"),B=M("ripple");return n(),a("span",{ref:"container",class:k(l.containerClass),"aria-haspopup":"listbox","aria-owns":l.listId,"aria-expanded":u.overlayVisible,style:x(i.style)},[i.multiple?v("",!0):(n(),a("input",I({key:0,ref:"input",class:l.inputFieldClass,style:i.inputStyle},e.$attrs,{value:l.inputValue,onClick:t[0]||(t[0]=(...s)=>l.onInputClicked&&l.onInputClicked(...s)),onInput:t[1]||(t[1]=(...s)=>l.onInput&&l.onInput(...s)),onFocus:t[2]||(t[2]=(...s)=>l.onFocus&&l.onFocus(...s)),onBlur:t[3]||(t[3]=(...s)=>l.onBlur&&l.onBlur(...s)),onKeydown:t[4]||(t[4]=(...s)=>l.onKeyDown&&l.onKeyDown(...s)),onChange:t[5]||(t[5]=(...s)=>l.onChange&&l.onChange(...s)),type:"text",autoComplete:"off",role:"searchbox","aria-autocomplete":"list","aria-controls":l.listId}),null,16,Y)),i.multiple?(n(),a("ul",{key:1,ref:"multiContainer",class:k(l.multiContainerClass),onClick:t[11]||(t[11]=(...s)=>l.onMultiContainerClick&&l.onMultiContainerClick(...s))},[(n(!0),a(y,null,V(i.modelValue,(s,C)=>(n(),a("li",{key:C,class:"p-autocomplete-token"},[h(e.$slots,"chip",{value:s},()=>[c("span",$,O(l.getItemContent(s)),1)]),c("span",{class:"p-autocomplete-token-icon pi pi-times-circle",onClick:b=>l.removeItem(b,C)},null,8,ee)]))),128)),c("li",te,[c("input",I({ref:"input",type:"text",autoComplete:"off"},e.$attrs,{onInput:t[6]||(t[6]=(...s)=>l.onInput&&l.onInput(...s)),onFocus:t[7]||(t[7]=(...s)=>l.onFocus&&l.onFocus(...s)),onBlur:t[8]||(t[8]=(...s)=>l.onBlur&&l.onBlur(...s)),onKeydown:t[9]||(t[9]=(...s)=>l.onKeyDown&&l.onKeyDown(...s)),onChange:t[10]||(t[10]=(...s)=>l.onChange&&l.onChange(...s)),role:"searchbox","aria-autocomplete":"list","aria-controls":l.listId}),null,16,le)])],2)):v("",!0),u.searching?(n(),a("i",ie)):v("",!0),i.dropdown?(n(),E(R,{key:3,ref:"dropdownButton",type:"button",icon:"pi pi-chevron-down",class:"p-autocomplete-dropdown",disabled:e.$attrs.disabled,onClick:l.onDropdownClick},null,8,["disabled","onClick"])):v("",!0),(n(),E(j,{to:l.appendTarget,disabled:l.appendDisabled},[F(A,{name:"p-connected-overlay",onEnter:l.onOverlayEnter,onLeave:l.onOverlayLeave,onAfterLeave:l.onOverlayAfterLeave},{default:S(()=>[u.overlayVisible?(n(),a("div",{key:0,ref:l.overlayRef,class:k(l.panelStyleClass),style:x({"max-height":l.virtualScrollerDisabled?i.scrollHeight:""}),onClick:t[12]||(t[12]=(...s)=>l.onOverlayClick&&l.onOverlayClick(...s))},[h(e.$slots,"header",{value:i.modelValue,suggestions:i.suggestions}),F(T,I({ref:l.virtualScrollerRef},i.virtualScrollerOptions,{style:{height:i.scrollHeight},items:i.suggestions,disabled:l.virtualScrollerDisabled}),P({content:S(({styleClass:s,contentRef:C,items:b,getItemOptions:m,contentStyle:G})=>[c("ul",{id:l.listId,ref:o=>l.listRef(o,C),class:k(["p-autocomplete-items",s]),style:x(G),role:"listbox"},[i.optionGroupLabel?(n(!0),a(y,{key:1},V(b,(o,f)=>(n(),a(y,{key:l.getOptionGroupRenderKey(o)},[c("li",re,[h(e.$slots,"optiongroup",{item:o,index:l.getOptionIndex(f,m)},()=>[D(O(l.getOptionGroupLabel(o)),1)])]),(n(!0),a(y,null,V(l.getOptionGroupChildren(o),(g,w)=>z((n(),a("li",{class:"p-autocomplete-item",key:w,onClick:K=>l.selectItem(K,g),role:"option","data-group":f,"data-index":l.getOptionIndex(w,m)},[h(e.$slots,"item",{item:g,index:l.getOptionIndex(w,m)},()=>[D(O(l.getItemContent(g)),1)])],8,ae)),[[B]])),128))],64))),128)):(n(!0),a(y,{key:0},V(b,(o,f)=>z((n(),a("li",{class:"p-autocomplete-item",key:l.getOptionRenderKey(o),onClick:g=>l.selectItem(g,o),role:"option","data-index":l.getOptionIndex(f,m)},[h(e.$slots,"item",{item:o,index:l.getOptionIndex(f,m)},()=>[D(O(l.getItemContent(o)),1)])],8,ne)),[[B]])),128))],14,se)]),_:2},[e.$slots.loader?{name:"loader",fn:S(({options:s})=>[h(e.$slots,"loader",{options:s})])}:void 0]),1040,["style","items","disabled"]),h(e.$slots,"footer",{value:i.modelValue,suggestions:i.suggestions})],6)):v("",!0)]),_:3},8,["onEnter","onLeave","onAfterLeave"])],8,["to","disabled"]))],14,X)}var fe=J(Q,[["render",oe]]);export{fe as default};
