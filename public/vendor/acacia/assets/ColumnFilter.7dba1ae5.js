var V=Object.defineProperty;var B=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var O=(e,t,l)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,f=(e,t)=>{for(var l in t||(t={}))R.call(t,l)&&O(e,l,t[l]);if(B)for(var l of B(t))x.call(t,l)&&O(e,l,t[l]);return e};import{Z as M,X as m,a5 as D,a3 as F,c as n,n as a,G as h,l as o,p,e as w,w as T,T as _,K as z,r as E,o as s,N as g,F as b,m as S,v as K,t as A,f as d}from"./main.9e765f7d.js";import{O as C}from"./overlayeventbus.esm.ef5cc0da.js";import{s as H}from"./dropdown.esm.5bafa883.js";import{s as I}from"./button.esm.a5ac1061.js";import{_ as N}from"./plugin-vue_export-helper.21dcd24c.js";import"./ripple.esm.1fe20658.js";import"./virtualscroller.esm.76cd2139.js";const U={name:"ColumnFilter",emits:["filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{field:{type:String,default:null},type:{type:String,default:"text"},display:{type:String,default:null},showMenu:{type:Boolean,default:!0},matchMode:{type:String,default:null},showOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},matchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},filterElement:null,filterHeaderTemplate:null,filterFooterTemplate:null,filterClearTemplate:null,filterApplyTemplate:null,filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null}},data(){return{overlayVisible:!1,defaultMatchMode:null,defaultOperator:null}},overlay:null,selfClick:!1,overlayEventListener:null,beforeUnmount(){this.overlayEventListener&&(C.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.overlay&&(M.clear(this.overlay),this.onOverlayHide())},mounted(){if(this.filters&&this.filters[this.field]){let e=this.filters[this.field];e.operator?(this.defaultMatchMode=e.constraints[0].matchMode,this.defaultOperator=e.operator):this.defaultMatchMode=this.filters[this.field].matchMode}},methods:{clearFilter(){let e=f({},this.filters);e[this.field].operator?(e[this.field].constraints.splice(1),e[this.field].operator=this.defaultOperator,e[this.field].constraints[0]={value:null,matchMode:this.defaultMatchMode}):(e[this.field].value=null,e[this.field].matchMode=this.defaultMatchMode),this.$emit("filter-clear"),this.$emit("filter-change",e),this.$emit("filter-apply"),this.hide()},applyFilter(){this.$emit("apply-click",{field:this.field,constraints:this.filters[this.field]}),this.$emit("filter-apply"),this.hide()},hasFilter(){if(this.filtersStore){let e=this.filtersStore[this.field];if(e)return e.operator?!this.isFilterBlank(e.constraints[0].value):!this.isFilterBlank(e.value)}return!1},hasRowFilter(){return this.filters[this.field]&&!this.isFilterBlank(this.filters[this.field].value)},isFilterBlank(e){return e!=null?typeof e=="string"&&e.trim().length==0||e instanceof Array&&e.length==0:!0},toggleMenu(){this.overlayVisible=!this.overlayVisible},onToggleButtonKeyDown(e){switch(e.key){case"Escape":case"Tab":this.overlayVisible=!1;break;case"ArrowDown":if(this.overlayVisible){let t=m.getFocusableElements(this.overlay);t&&t[0].focus(),e.preventDefault()}else e.altKey&&(this.overlayVisible=!0,e.preventDefault());break}},onEscape(){this.overlayVisible=!1,this.$refs.icon&&this.$refs.icon.focus()},onRowMatchModeChange(e){let t=f({},this.filters);t[this.field].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e}),this.$emit("filter-change",t),this.$emit("filter-apply"),this.hide()},onRowMatchModeKeyDown(e){let t=e.target;switch(e.key){case"ArrowDown":var l=this.findNextItem(t);l&&(t.removeAttribute("tabindex"),l.tabIndex="0",l.focus()),e.preventDefault();break;case"ArrowUp":var y=this.findPrevItem(t);y&&(t.removeAttribute("tabindex"),y.tabIndex="0",y.focus()),e.preventDefault();break}},isRowMatchModeSelected(e){return this.filters[this.field].matchMode===e},onOperatorChange(e){let t=f({},this.filters);t[this.field].operator=e,this.$emit("filter-change",t),this.$emit("operator-change",{field:this.field,operator:e}),this.showApplyButton||this.$emit("filter-apply")},onMenuMatchModeChange(e,t){let l=f({},this.filters);l[this.field].constraints[t].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e,index:t}),this.showApplyButton||this.$emit("filter-apply")},addConstraint(){let e=f({},this.filters),t={value:null,matchMode:this.defaultMatchMode};e[this.field].constraints.push(t),this.$emit("constraint-add",{field:this.field,constraing:t}),this.$emit("filter-change",e),this.showApplyButton||this.$emit("filter-apply")},removeConstraint(e){let t=f({},this.filters),l=t[this.field].constraints.splice(e,1);this.$emit("constraint-remove",{field:this.field,constraing:l}),this.$emit("filter-change",t),this.showApplyButton||this.$emit("filter-apply")},filterCallback(){this.$emit("filter-apply")},findNextItem(e){let t=e.nextElementSibling;return t?m.hasClass(t,"p-column-filter-separator")?this.findNextItem(t):t:e.parentElement.firstElementChild},findPrevItem(e){let t=e.previousElementSibling;if(t)m.hasClass(t,"p-column-filter-separator")&&this.findPrevItem(t);else return e.parentElement.lastElementChild},hide(){this.overlayVisible=!1},onContentClick(e){this.selfClick=!0,C.emit("overlay-click",{originalEvent:e,target:this.overlay})},onContentMouseDown(){this.selfClick=!0},onOverlayEnter(e){this.filterMenuStyle&&m.applyStyle(this.overlay,this.filterMenuStyle),M.set("overlay",e,this.$primevue.config.zIndex.overlay),m.absolutePosition(this.overlay,this.$refs.icon),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.overlayEventListener=t=>{this.isOutsideClicked(t.target)||(this.selfClick=!0)},C.on("overlay-click",this.overlayEventListener)},onOverlayLeave(){this.onOverlayHide()},onOverlayAfterLeave(e){M.clear(e)},onOverlayHide(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.overlay=null,C.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},overlayRef(e){this.overlay=e},isOutsideClicked(e){return!this.isTargetClicked(e)&&this.overlay&&!(this.overlay.isSameNode(e)||this.overlay.contains(e))},isTargetClicked(e){return this.$refs.icon&&(this.$refs.icon.isSameNode(e)||this.$refs.icon.contains(e))},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=e=>{this.overlayVisible&&!this.selfClick&&this.isOutsideClicked(e.target)&&(this.overlayVisible=!1),this.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new D(this.$refs.icon,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&this.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}},computed:{containerClass(){return["p-column-filter p-fluid",{"p-column-filter-row":this.display==="row","p-column-filter-menu":this.display==="menu"}]},overlayClass(){return[this.filterMenuClass,{"p-column-filter-overlay p-component p-fluid":!0,"p-column-filter-overlay-menu":this.display==="menu","p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},showMenuButton(){return this.showMenu&&(this.display==="row"?this.type!=="boolean":!0)},matchModes(){return this.matchModeOptions||this.$primevue.config.filterMatchModeOptions[this.type].map(e=>({label:this.$primevue.config.locale[e],value:e}))},isShowMatchModes(){return this.type!=="boolean"&&this.showMatchModes&&this.matchModes},operatorOptions(){return[{label:this.$primevue.config.locale.matchAll,value:F.AND},{label:this.$primevue.config.locale.matchAny,value:F.OR}]},noFilterLabel(){return this.$primevue.config.locale.noFilter},isShowOperator(){return this.showOperator&&this.filters[this.field].operator},operator(){return this.filters[this.field].operator},fieldConstraints(){return this.filters[this.field].constraints||[this.filters[this.field]]},showRemoveIcon(){return this.fieldConstraints.length>1},removeRuleButtonLabel(){return this.$primevue.config.locale.removeRule},addRuleButtonLabel(){return this.$primevue.config.locale.addRule},isShowAddConstraint(){return this.showAddButton&&this.filters[this.field].operator&&this.fieldConstraints&&this.fieldConstraints.length<this.maxConstraints},clearButtonLabel(){return this.$primevue.config.locale.clear},applyButtonLabel(){return this.$primevue.config.locale.apply}},components:{CFDropdown:H,CFButton:I}},P={key:0,class:"p-fluid p-column-filter-element"},j=["aria-expanded"],Z=d("span",{class:"pi pi-filter-icon pi-filter"},null,-1),G=[Z],X=d("span",{class:"pi pi-filter-slash"},null,-1),q=[X],J={key:0,class:"p-column-filter-row-items"},Q=["onClick","onKeydown","tabindex"],W=d("li",{class:"p-column-filter-separator"},null,-1),Y={key:0,class:"p-column-filter-operator"},$={class:"p-column-filter-constraints"},ee={key:1,class:"p-column-filter-add-rule"},te={class:"p-column-filter-buttonbar"};function le(e,t,l,y,k,i){const L=E("CFDropdown"),v=E("CFButton");return s(),n("div",{class:p(i.containerClass)},[l.display==="row"?(s(),n("div",P,[(s(),a(h(l.filterElement),{field:l.field,filterModel:l.filters[l.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"]))])):o("",!0),i.showMenuButton?(s(),n("button",{key:1,ref:"icon",type:"button",class:p(["p-column-filter-menu-button p-link",{"p-column-filter-menu-button-open":k.overlayVisible,"p-column-filter-menu-button-active":i.hasFilter()}]),"aria-haspopup":"true","aria-expanded":k.overlayVisible,onClick:t[0]||(t[0]=r=>i.toggleMenu()),onKeydown:t[1]||(t[1]=r=>i.onToggleButtonKeyDown(r))},G,42,j)):o("",!0),l.showClearButton&&l.display==="row"?(s(),n("button",{key:2,class:p([{"p-hidden-space":!i.hasRowFilter()},"p-column-filter-clear-button p-link"]),type:"button",onClick:t[2]||(t[2]=r=>i.clearFilter())},q,2)):o("",!0),(s(),a(z,{to:"body"},[w(_,{name:"p-connected-overlay",onEnter:i.onOverlayEnter,onLeave:i.onOverlayLeave,onAfterLeave:i.onOverlayAfterLeave},{default:T(()=>[k.overlayVisible?(s(),n("div",{key:0,ref:i.overlayRef,class:p(i.overlayClass),onKeydown:t[11]||(t[11]=g((...r)=>i.onEscape&&i.onEscape(...r),["escape"])),onClick:t[12]||(t[12]=(...r)=>i.onContentClick&&i.onContentClick(...r)),onMousedown:t[13]||(t[13]=(...r)=>i.onContentMouseDown&&i.onContentMouseDown(...r))},[(s(),a(h(l.filterHeaderTemplate),{field:l.field,filterModel:l.filters[l.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"])),l.display==="row"?(s(),n("ul",J,[(s(!0),n(b,null,S(i.matchModes,(r,c)=>(s(),n("li",{class:p(["p-column-filter-row-item",{"p-highlight":i.isRowMatchModeSelected(r.value)}]),key:r.label,onClick:u=>i.onRowMatchModeChange(r.value),onKeydown:[t[3]||(t[3]=u=>i.onRowMatchModeKeyDown(u)),g(K(u=>i.onRowMatchModeChange(r.value),["prevent"]),["enter"])],tabindex:c===0?"0":null},A(r.label),43,Q))),128)),W,d("li",{class:"p-column-filter-row-item",onClick:t[4]||(t[4]=r=>i.clearFilter()),onKeydown:[t[5]||(t[5]=r=>i.onRowMatchModeKeyDown(r)),t[6]||(t[6]=g(r=>e.onRowClearItemClick(),["enter"]))]},A(i.noFilterLabel),33)])):(s(),n(b,{key:1},[i.isShowOperator?(s(),n("div",Y,[w(L,{options:i.operatorOptions,modelValue:i.operator,"onUpdate:modelValue":t[7]||(t[7]=r=>i.onOperatorChange(r)),class:"p-column-filter-operator-dropdown",optionLabel:"label",optionValue:"value"},null,8,["options","modelValue"])])):o("",!0),d("div",$,[(s(!0),n(b,null,S(i.fieldConstraints,(r,c)=>(s(),n("div",{key:c,class:"p-column-filter-constraint"},[i.isShowMatchModes?(s(),a(L,{key:0,options:i.matchModes,modelValue:r.matchMode,optionLabel:"label",optionValue:"value","onUpdate:modelValue":u=>i.onMenuMatchModeChange(u,c),class:"p-column-filter-matchmode-dropdown"},null,8,["options","modelValue","onUpdate:modelValue"])):o("",!0),l.display==="menu"?(s(),a(h(l.filterElement),{key:1,field:l.field,filterModel:r,filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"])):o("",!0),d("div",null,[i.showRemoveIcon?(s(),a(v,{key:0,type:"button",icon:"pi pi-trash",class:"p-column-filter-remove-button p-button-text p-button-danger p-button-sm",onClick:u=>i.removeConstraint(c),label:i.removeRuleButtonLabel},null,8,["onClick","label"])):o("",!0)])]))),128))]),i.isShowAddConstraint?(s(),n("div",ee,[w(v,{type:"button",label:i.addRuleButtonLabel,icon:"pi pi-plus",class:"p-column-filter-add-button p-button-text p-button-sm",onClick:t[8]||(t[8]=r=>i.addConstraint())},null,8,["label"])])):o("",!0),d("div",te,[!l.filterClearTemplate&&l.showClearButton?(s(),a(v,{key:0,type:"button",class:"p-button-outlined p-button-sm",onClick:t[9]||(t[9]=r=>i.clearFilter()),label:i.clearButtonLabel},null,8,["label"])):(s(),a(h(l.filterClearTemplate),{key:1,field:l.field,filterModel:l.filters[l.field],filterCallback:i.clearFilter},null,8,["field","filterModel","filterCallback"])),l.showApplyButton?(s(),n(b,{key:2},[l.filterApplyTemplate?(s(),a(h(l.filterApplyTemplate),{key:1,field:l.field,filterModel:l.filters[l.field],filterCallback:i.applyFilter},null,8,["field","filterModel","filterCallback"])):(s(),a(v,{key:0,type:"button",class:"p-button-sm",onClick:t[10]||(t[10]=r=>i.applyFilter()),label:i.applyButtonLabel},null,8,["label"]))],64)):o("",!0)])],64)),(s(),a(h(l.filterFooterTemplate),{field:l.field,filterModel:l.filters[l.field],filterCallback:i.filterCallback},null,8,["field","filterModel","filterCallback"]))],34)):o("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])]))],2)}var ue=N(U,[["render",le]]);export{ue as default};
