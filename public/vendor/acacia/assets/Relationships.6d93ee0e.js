var q=Object.defineProperty,$=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var _=(r,e,t)=>e in r?q(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,x=(r,e)=>{for(var t in e||(e={}))B.call(e,t)&&_(r,t,e[t]);if(v)for(var t of v(e))F.call(e,t)&&_(r,t,e[t]);return r},w=(r,e)=>$(r,A(e));import K from"./PrimeDatatables.0582f2ad.js";import{s as c}from"./column.esm.6c61d2a3.js";import{s as N}from"./button.esm.a5ac1061.js";import{s as O}from"./contextmenu.esm.bb623b07.js";import{d as C,j as d,a as U,b as V,c as j,e as i,w as h,g as a,h as f,$ as z,F as I,i as L,M as k,a0 as P,o as G,q as H,t as J,p as Q}from"./main.9e765f7d.js";import"./inputtext.esm.dc0f2264.js";import"./datatable.esm.3689bee8.js";import"./paginator.esm.d428c35b.js";import"./ripple.esm.1fe20658.js";import"./dropdown.esm.5bafa883.js";import"./overlayeventbus.esm.ef5cc0da.js";import"./virtualscroller.esm.76cd2139.js";import"./inputnumber.esm.2f528c5c.js";import"./plugin-vue_export-helper.21dcd24c.js";const W=C({name:"Relationships",props:{model:{required:!0}}}),ue=C(w(x({},W),{setup(r){const e=d(["id","type","method","related_key"]),t=d(null),u=d(),p=d([]),M=U(),y=V(),b=d(null),g=o=>[{label:"Edit",icon:"pi pi-pencil",command:()=>L.Inertia.get(f("sms.sending-sessions.show",o)),visible:()=>!0},{label:"Delete",icon:"pi pi-trash",command:()=>{M.require({message:"Are you sure you want to delete this record?",header:"Confirm Deletion",accept:()=>D(o)})},visible:()=>!0}],R=()=>{b.value=new Date().toUTCString()},S=async(o,l)=>{p.value=g(l),await k(),u.value.show(o)},T=async o=>{p.value=g(o.data),await k(),u.value.show(o.originalEvent)},D=async function(o){var l,n,m;try{const s=await P.delete(f("api.sms.sending-sessions.destroy",o));y.add({severity:"success",detail:s.data.message}),R()}catch(s){const E=((n=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:n.message)||((m=s==null?void 0:s.data)==null?void 0:m.message)||(s==null?void 0:s.message)||s||"Server error";y.add({severity:"error",detail:E,summary:"Server Error"})}};return(o,l)=>(G(),j(I,null,[i(K,{"api-url":a(f)("api.acacia.schematics.schematic.relationships",o.model.id),"column-filters":{},"searchable-columns":e.value,"state-key":"schematic-fields-dt",contextMenu:"",contextMenuSelection:a(t),"onUpdate:contextMenuSelection":l[0]||(l[0]=n=>z(t)?t.value=n:null),onRowContextmenu:T,"row-hover":!0,refresh:a(b)},{default:h(()=>[i(a(c),{field:"method",header:"Method",sortable:!0},{body:h(({data:n})=>[H(J(n.method)+"()",1)]),_:1}),i(a(c),{field:"type",header:"Relationship Type",sortable:!0}),i(a(c),{field:"related_table",header:"Related Table",sortable:!0}),i(a(c),{field:"local_key",header:"Local Key",sortable:!0}),i(a(c),{field:"related_key",header:"Related Key",sortable:!0}),i(a(c),null,{body:h(n=>[i(a(N),{class:Q(["","p-button-text"]),onClick:m=>S(m,n.data),"icon-pos":"right",icon:"pi pi-ellipsis-v",label:"Actions"},null,8,["onClick"])]),_:1})]),_:1},8,["api-url","searchable-columns","contextMenuSelection","refresh"]),i(a(O),{ref_key:"contextMenu",ref:u,model:a(p)},null,8,["model"])],64))}}));export{ue as default};
