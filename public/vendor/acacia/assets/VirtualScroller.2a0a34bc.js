var k=Object.defineProperty,O=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var H=(t,s,e)=>s in t?k(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,V=(t,s)=>{for(var e in s||(s={}))F.call(s,e)&&H(t,e,s[e]);if(_)for(var e of _(s))N.call(s,e)&&H(t,e,s[e]);return t},P=(t,s)=>O(t,M(s));import{_ as D}from"./plugin-vue_export-helper.21dcd24c.js";import{i as z,q as C,an as b,s as R,x as L,F as v,t as A,o as y,k as W}from"./vendor.05df324e.js";const E={name:"VirtualScroller",emits:["update:numToleratedItems","scroll","scroll-index-change","lazy-load"],props:{id:{type:String,default:null},style:null,class:null,items:{type:Array,default:null},itemSize:{type:[Number,Array],default:0},scrollHeight:null,scrollWidth:null,orientation:{type:String,default:"vertical"},numToleratedItems:{type:Number,default:null},delay:{type:Number,default:0},lazy:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loaderDisabled:{type:Boolean,default:!1},columns:{type:Array,default:null},loading:{type:Boolean,default:!1},showSpacer:{type:Boolean,default:!0},showLoader:{type:Boolean,default:!1}},data(){return{first:this.isBoth()?{rows:0,cols:0}:0,last:this.isBoth()?{rows:0,cols:0}:0,numItemsInViewport:this.isBoth()?{rows:0,cols:0}:0,lastScrollPos:this.isBoth()?{top:0,left:0}:0,d_numToleratedItems:this.numToleratedItems,d_loading:this.loading,loaderArr:[],spacerStyle:{},contentStyle:{}}},element:null,content:null,lastScrollPos:null,scrollTimeout:null,mounted(){this.init(),this.lastScrollPos=this.isBoth()?{top:0,left:0}:0},watch:{numToleratedItems(t){this.d_numToleratedItems=t},loading(t){this.d_loading=t},items(t,s){(!s||s.length!==(t||[]).length)&&this.init()},orientation(){this.lastScrollPos=this.isBoth()?{top:0,left:0}:0}},methods:{init(){this.setSize(),this.calculateOptions(),this.setSpacerSize()},isVertical(){return this.orientation==="vertical"},isHorizontal(){return this.orientation==="horizontal"},isBoth(){return this.orientation==="both"},scrollTo(t){this.element&&this.element.scrollTo(t)},scrollToIndex(t,s="auto"){const e=this.isBoth(),n=this.isHorizontal(),l=this.getContentPosition(),i=(a=0,f)=>a<=f?0:a,o=(a,f,c)=>a*f+c,r=(a=0,f=0)=>this.scrollTo({left:a,top:f,behavior:s});if(e){const a={rows:i(t[0],this.d_numToleratedItems[0]),cols:i(t[1],this.d_numToleratedItems[1])};(a.rows!==this.first.rows||a.cols!==this.first.cols)&&(r(o(a.cols,this.itemSize[1],l.left),o(a.rows,this.itemSize[0],l.top)),this.first=a)}else{const a=i(t,this.d_numToleratedItems);a!==this.first&&(n?r(o(a,this.itemSize,l.left),0):r(0,o(a,this.itemSize,l.top)),this.first=a)}},scrollInView(t,s,e="auto"){if(s){const n=this.isBoth(),l=this.isHorizontal(),{first:i,viewport:o}=this.getRenderedRange(),r=(c=0,u=0)=>this.scrollTo({left:c,top:u,behavior:e}),a=s==="to-start",f=s==="to-end";if(a){if(n)o.first.rows-i.rows>t[0]?r(o.first.cols*this.itemSize[1],(o.first.rows-1)*this.itemSize[0]):o.first.cols-i.cols>t[1]&&r((o.first.cols-1)*this.itemSize[1],o.first.rows*this.itemSize[0]);else if(o.first-i>t){const c=(o.first-1)*this.itemSize;l?r(c,0):r(0,c)}}else if(f){if(n)o.last.rows-i.rows<=t[0]+1?r(o.first.cols*this.itemSize[1],(o.first.rows+1)*this.itemSize[0]):o.last.cols-i.cols<=t[1]+1&&r((o.first.cols+1)*this.itemSize[1],o.first.rows*this.itemSize[0]);else if(o.last-i<=t+1){const c=(o.first+1)*this.itemSize;l?r(c,0):r(0,c)}}}else this.scrollToIndex(t,e)},getRenderedRange(){const t=(n,l)=>Math.floor(n/(l||n));let s=this.first,e=0;if(this.element){const n=this.isBoth(),l=this.isHorizontal(),i=this.element.scrollTop,o=this.element.scrollLeft;n?(s={rows:t(i,this.itemSize[0]),cols:t(o,this.itemSize[1])},e={rows:s.rows+this.numItemsInViewport.rows,cols:s.cols+this.numItemsInViewport.cols}):(s=t(l?o:i,this.itemSize),e=s+this.numItemsInViewport)}return{first:this.first,last:this.last,viewport:{first:s,last:e}}},calculateOptions(){const t=this.isBoth(),s=this.isHorizontal(),e=this.getContentPosition(),n=this.element?this.element.offsetWidth-e.left:0,l=this.element?this.element.offsetHeight-e.top:0,i=(u,g)=>Math.ceil(u/(g||u)),o=u=>Math.ceil(u/2),r=t?{rows:i(l,this.itemSize[0]),cols:i(n,this.itemSize[1])}:i(s?n:l,this.itemSize);let a=this.d_numToleratedItems||(t?[o(r.rows),o(r.cols)]:o(r));const f=(u,g,w,T)=>this.getLast(u+g+(u<w?2:3)*w,T),c=t?{rows:f(this.first.rows,r.rows,a[0]),cols:f(this.first.cols,r.cols,a[1],!0)}:f(this.first,r,a);this.last=c,this.numItemsInViewport=r,this.d_numToleratedItems=a,this.$emit("update:numToleratedItems",this.d_numToleratedItems),this.showLoader&&(this.loaderArr=t?Array.from({length:r.rows}).map(()=>Array.from({length:r.cols})):Array.from({length:r})),this.lazy&&this.$emit("lazy-load",{first:this.first,last:c})},getLast(t=0,s){return this.items?Math.min(s?(this.columns||this.items[0]).length:this.items.length,t):0},getContentPosition(){if(this.content){const t=getComputedStyle(this.content),s=parseInt(t.paddingLeft,10)+Math.max(parseInt(t.left,10),0),e=parseInt(t.paddingRight,10)+Math.max(parseInt(t.right,10),0),n=parseInt(t.paddingTop,10)+Math.max(parseInt(t.top,10),0),l=parseInt(t.paddingBottom,10)+Math.max(parseInt(t.bottom,10),0);return{left:s,right:e,top:n,bottom:l,x:s+e,y:n+l}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}},setSize(){if(this.element){const t=this.isBoth(),s=this.isHorizontal(),e=this.element.parentElement,n=this.scrollWidth||`${this.element.offsetWidth||e.offsetWidth}px`,l=this.scrollHeight||`${this.element.offsetHeight||e.offsetHeight}px`,i=(o,r)=>this.element.style[o]=r;t||s?(i("height",l),i("width",n)):i("height",l)}},setSpacerSize(){const t=this.items;if(t){const s=this.isBoth(),e=this.isHorizontal(),n=this.getContentPosition(),l=(i,o,r,a=0)=>this.spacerStyle=P(V({},this.spacerStyle),{[`${i}`]:(o||[]).length*r+a+"px"});s?(l("height",t,this.itemSize[0],n.y),l("width",this.columns||t[1],this.itemSize[1],n.x)):e?l("width",this.columns||t,this.itemSize,n.x):l("height",t,this.itemSize,n.y)}},setContentPosition(t){if(this.content){const s=this.isBoth(),e=this.isHorizontal(),n=t?t.first:this.first,l=(o,r)=>o*r,i=(o=0,r=0)=>{this.contentStyle=P(V({},this.contentStyle),{transform:`translate3d(${o}px, ${r}px, 0)`})};if(s)i(l(n.cols,this.itemSize[1]),l(n.rows,this.itemSize[0]));else{const o=l(n,this.itemSize);e?i(o,0):i(0,o)}}},onScrollPositionChange(t){const s=t.target,e=this.isBoth(),n=this.isHorizontal(),l=this.getContentPosition(),i=(h,m)=>h?h>m?h-m:h:0,o=(h,m)=>Math.floor(h/(m||h)),r=(h,m,d,p,S,I)=>h<=S?S:I?d-p-S:m+S-1,a=(h,m,d,p,S,I,B)=>h<=I?0:Math.max(0,B?h<m?d:h-I:h>m?d:h-2*I),f=(h,m,d,p,S,I)=>{let B=m+p+2*S;return h>=S&&(B+=S+1),this.getLast(B,I)},c=i(s.scrollTop,l.top),u=i(s.scrollLeft,l.left);let g=0,w=this.last,T=!1;if(e){const h=this.lastScrollPos.top<=c,m=this.lastScrollPos.left<=u,d={rows:o(c,this.itemSize[0]),cols:o(u,this.itemSize[1])},p={rows:r(d.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],h),cols:r(d.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],m)};g={rows:a(d.rows,p.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],h),cols:a(d.cols,p.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],m)},w={rows:f(d.rows,g.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:f(d.cols,g.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},T=g.rows!==this.first.rows&&w.rows!==this.last.rows||g.cols!==this.first.cols&&w.cols!==this.last.cols,this.lastScrollPos={top:c,left:u}}else{const h=n?u:c,m=this.lastScrollPos<=h,d=o(h,this.itemSize),p=r(d,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,m);g=a(d,p,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,m),w=f(d,g,this.last,this.numItemsInViewport,this.d_numToleratedItems),T=g!==this.first&&w!==this.last,this.lastScrollPos=h}return{first:g,last:w,isRangeChanged:T}},onScrollChange(t){const{first:s,last:e,isRangeChanged:n}=this.onScrollPositionChange(t);if(n){const l={first:s,last:e};this.setContentPosition(l),this.first=s,this.last=e,this.$emit("scroll-index-change",l),this.lazy&&this.$emit("lazy-load",l)}},onScroll(t){if(this.$emit("scroll",t),this.delay){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){const{isRangeChanged:s}=this.onScrollPositionChange(t);s&&(this.d_loading=!0)}this.scrollTimeout=setTimeout(()=>{this.onScrollChange(t),this.d_loading&&this.showLoader&&!this.lazy&&(this.d_loading=!1)},this.delay)}else this.onScrollChange(t)},getOptions(t){const s=(this.items||[]).length,e=this.isBoth()?this.first.rows+t:this.first+t;return{index:e,count:s,first:e===0,last:e===s-1,even:e%2==0,odd:e%2!=0}},getLoaderOptions(t,s){let e=this.loaderArr.length;return V({index:t,count:e,first:t===0,last:t===e-1,even:t%2==0,odd:t%2!=0},s)},elementRef(t){this.element=t},contentRef(t){this.content=t}},computed:{containerClass(){return["p-virtualscroller",{"p-both-scroll":this.isBoth(),"p-horizontal-scroll":this.isHorizontal()},this.class]},contentClass(){return["p-virtualscroller-content",{"p-virtualscroller-loading":this.d_loading}]},loaderClass(){return["p-virtualscroller-loader",{"p-component-overlay":!this.$slots.loader}]},loadedItems(){const t=this.items;return t&&!this.d_loading?this.isBoth()?t.slice(this.first.rows,this.last.rows).map(s=>this.columns?s:s.slice(this.first.cols,this.last.cols)):this.isHorizontal()&&this.columns?t:t.slice(this.first,this.last):[]},loadedRows(){return this.d_loading?this.loaderDisabled?this.loaderArr:[]:this.loadedItems},loadedColumns(){if(this.columns){const t=this.isBoth(),s=this.isHorizontal();if(t||s)return this.d_loading&&this.loaderDisabled?t?this.loaderArr[0]:this.loaderArr:this.columns.slice(t?this.first.cols:this.first,t?this.last.cols:this.last)}return this.columns}}},x={key:1,class:"p-virtualscroller-loading-icon pi pi-spinner pi-spin"};function j(t,s,e,n,l,i){return e.disabled?(y(),z(v,{key:1},[C(t.$slots,"default"),C(t.$slots,"content",{items:e.items,rows:e.items,columns:i.loadedColumns})],64)):(y(),z("div",{key:0,ref:i.elementRef,class:L(i.containerClass),tabindex:0,style:b(e.style),onScroll:s[0]||(s[0]=(...o)=>i.onScroll&&i.onScroll(...o))},[C(t.$slots,"content",{styleClass:i.contentClass,items:i.loadedItems,getItemOptions:i.getOptions,loading:l.d_loading,getLoaderOptions:i.getLoaderOptions,itemSize:e.itemSize,rows:i.loadedRows,columns:i.loadedColumns,contentRef:i.contentRef,spacerStyle:l.spacerStyle,contentStyle:l.contentStyle,vertical:i.isVertical(),horizontal:i.isHorizontal(),both:i.isBoth()},()=>[W("div",{ref:i.contentRef,class:L(i.contentClass),style:b(l.contentStyle)},[(y(!0),z(v,null,A(i.loadedItems,(o,r)=>C(t.$slots,"item",{key:r,item:o,options:i.getOptions(r)})),128))],6)]),e.showSpacer?(y(),z("div",{key:0,class:"p-virtualscroller-spacer",style:b(l.spacerStyle)},null,4)):R("",!0),!e.loaderDisabled&&e.showLoader&&l.d_loading?(y(),z("div",{key:1,class:L(i.loaderClass)},[t.$slots&&t.$slots.loader?(y(!0),z(v,{key:0},A(l.loaderArr,(o,r)=>C(t.$slots,"loader",{key:r,options:i.getLoaderOptions(r,i.isBoth()&&{numCols:t.d_numItemsInViewport.cols})})),128)):(y(),z("i",x))],2)):R("",!0)],38))}var K=D(E,[["render",j]]);export{K as default};
